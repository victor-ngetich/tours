{% extends 'dashboard/bookingsbase.html' %}
{% load staticfiles %}

{% block head %}

<!doctype html>
<html lang="en">
 
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Favicon -->
    <link rel="icon" href="{% static 'images/core-img/favicon.ico' %}?{% now "U" %}">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}?{% now "U" %}">
    <link href="{% static 'vendor/fonts/circular-std/style.css' %}?{% now "U" %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'libs/css/style.css' %}?{% now "U" %}">
    <link rel="stylesheet" href="{% static 'vendor/fonts/fontawesome/css/fontawesome-all.css' %}?{% now "U" %}">
    <!-- Libraries -->
    <script src="{% static 'libs/js/jquery-3.3.1.js' %}?{% now "U" %}"></script>
    <title>To Do Trips</title>
</head>

<style>
    .paypal-button {
        width:200px; /* you can use % */
        height: auto;
    }
    .payppal-button:focus, input:focus{
    outline: none;
    }
    /* *:focus {
    outline: none;
    } */
    </style>
{% endblock %}


{% block content %}
            <div class="influence-finder">
                <div class="container-fluid dashboard-content">
                    <!-- ============================================================== -->
                    <!-- pageheader -->
                    <!-- ============================================================== -->
                    <!-- <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                            <div class="page-header">
                                <h3 class="mb-2">Influencer Finder </h3>
                                <p class="pageheader-text">Proin placerat ante duiullam scelerisque a velit ac porta, fusce sit amet vestibulum mi. Morbi lobortis pulvinar quam.</p>
                                <div class="page-breadcrumb">
                                    <nav aria-label="breadcrumb">
                                        <ol class="breadcrumb">
                                            <li class="breadcrumb-item"><a href="#" class="breadcrumb-link">Dashboard</a></li>
                                            <li class="breadcrumb-item active" aria-current="page">Influencer Finder Template</li>
                                        </ol>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <!-- ============================================================== -->
                    <!-- end pageheader -->
                    <!-- ============================================================== -->
                    <!-- ============================================================== -->
                    <!-- content -->
                    <!-- ============================================================== -->

          <!-- A Bootstrap Modal -->

                    {% if messages %}
                    {% for message in messages %}
                        <!-- modal -->
                        <div id="custom-modal" class="modal fade" role="dialog">
                                <div class="modal-dialog">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h4 class="modal-title">Error</h4>
                                    </div>
                                    <div class="modal-body">
                        {{ message }}
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Dismiss</button>
                    </div>
                  </div>
                </div>
              </div>
                    {% endfor %}
                    {% endif %}
                    <!-- modal end -->
                    <div class="row">
                        <!-- ============================================================== -->
                        <!-- search bar  -->
                        <!-- ============================================================== -->
                        <!-- ============================================================== -->
                        <!-- end search bar  -->
                        <!-- ============================================================== -->
                        <div class="col-xl-9 col-lg-8 col-md-8 col-sm-12 col-12">
                            <!-- ============================================================== -->
                            <!-- card influencer one -->
                            <!-- ============================================================== -->
                            {% for p in a %}
                            <div class="card">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-xl-9 col-lg-12 col-md-12 col-sm-12 col-12">
                                                <div class="pl-xl-3">
                                                    <div class="m-b-0">
                                                        <div class="user-avatar-name d-inline-block">
                                                            <h2 class="font-24 m-b-10"  style="color:rgb(185, 93, 0);">{{p.p_name2}}</h2>
                                                            <h2 class="font-18 m-b-10 text-primary">{{p.d_name}}</h2>
                                                            <hr>
                                                        </div> 
                                                        {% if p.paid %}
                                                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                                                            <strong>Notice:</strong> Your have <strong>paid</strong> for your booking, mark your calender now!
                                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </div>
                                                        {% elif p.approved %}
                                                        <div class="alert alert-primary alert-dismissible fade show" role="alert">
                                                            <strong>Notice:</strong> Your booking has been <strong>approved</strong>, you can proceed to pay!
                                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                            </div>
                                                        {% else %}
                                                        <div class="alert alert-warning" role="alert">
                                                                Your booking approval is <strong>pending</strong>, kindly wait to be contacted
                                                              </div>
                                                        {% endif %} 
                                                    </div>
                                                    <div class="user-avatar-address">   
                                                        <div class="mt-3">
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Booked on:
                                                                <a class="mr-1 badge badge-light">{{p.date_added}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Travel Agency:
                                                                <a class="mr-1 badge badge-light">{{p.agencyname}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Agency Contact:
                                                                <a class="mr-1 badge badge-light">{{p.agencycontact}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Adults:
                                                                <a class="mr-1 badge badge-light">{{p.adults}}</a><i class="mr-2  text-primary"></i>Each: <a class="mr-1 badge badge-light">KSh. {{p.pricep_adult}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Kids:
                                                                <a class="mr-1 badge badge-light">{{p.kids}}</a><i class="mr-2  text-primary"></i>Each: <a class="mr-1 badge badge-light">KSh. {{p.pricep_kid}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>From:
                                                                <a class="mr-1 badge badge-light">{{p.start_date|date}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>To:
                                                                <a class="mr-1 badge badge-light">{{p.end_date|date}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Hotel:
                                                                <a class="mr-1 badge badge-light">{{p.hotel}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Total Days:
                                                                <a class="mr-1 badge badge-light">{{p.get_total_days}}</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Total Price:
                                                                <a class="mr-1 badge badge-light">KSh. {{p.get_total_price}}</a>
                                                                <a class="mr-2  text-primary">(${{p.get_usd_price}} USD)</a>
                                                            </p>
                                                            <p class="mb-2"><i class="mr-2  text-primary"></i>Booking ID:
                                                                <a class="mr-1 badge badge-light">{{p.id}}</a>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-lg-12 col-md-12 col-sm-12 col-12">
                                                {% if p.paid %}
                                                <a class="badge2 badge-light2">Payment done</a>
                                                        {% elif p.approved %}
                                                <div class="float-xl-right float-none mt-xl-0 mt-4" style="display: block;">
                                                    <br>
                                                    <br>
                                                    <!-- <a href="/payprocess/" class="btn btn-warning">Proceed to Pay</a> -->
                                                    <!-- Form action into a sandbox account -->
                                                    <form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post" name='_xclick' style="padding: 0; margin: 0;">
                                                        <input type="hidden" name="cmd" value="_xclick" />
                                                        <input type="hidden" name="business" value="vnpaypal@gmail.com" />
                                                        <input type="hidden" name="quantity" value="1" />
                                                        <input type="hidden" name="item_name" value="{{p.p_name2}}" />
                                                        <input type="hidden" name="item_number" value="{{p.id}}" />
                                                        <!-- Unique invoice to avoid paying for the same item again -->
                                                        <!-- <input type="hidden" name="invoice" value="{{p.id}}" > -->
                                                        <input type="hidden" name="amount" value="{{p.get_usd_price}}" />
                                                        <input type='hidden' name='no_shipping' value='1'>
                                                        <input type="hidden" name="no_note" value="1" />
                                                        <input type="hidden" name="notify_url" value="Your notify url">
                                                        <input type="hidden" name="currency_code" value="USD" />
                                                        <input type="hidden" name="rm" value="2" >
                                                        <!-- Any random variable -->
                                                        <!-- <input type="hidden" id="buybuttonid" name="custom" value="XXXXX" /> -->
                                                        <input type='hidden' name='cancel_return' value='http://127.0.0.1:8000/paycancel/'>
                                                        <input type="hidden" name="return" value="http://127.0.0.1:8000/paydone/?user={{user.get_username}}&packageid={{p.id}}">
                                                        <input type="image" class="paypal-button" name="paypal" src="{% static 'images/Paypal-Buy-Button.png' %}?{% now "U" %}" alt="Pay with Paypal" onClick="" name="submit"/>
                                                        </form>
                                                    <br>
                                                    <br>
                                                </div>
                                                

                                                {% else %}
                                                <!-- <div class="product-qty" style="color:white;"> -->
                                                    <!-- <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"> -->
                                            
                                                            <!-- <div class="float-xl-right float-none mt-xl-0 mt-4"> -->
                                                                <!-- <a class="btn btn-primary" href="/edit-booking/{{p.pk}}/" role="button">Edit Preferences</a> -->

                                                            <!-- </div> -->
                                                <!-- </div> -->
                                                <!-- </div> -->
                                                <!-- <br>
                                                <br>
                                                <br> -->
                                                {% endif %}

                                               

                                                <!-- <div class="float-xl-right float-none mt-xl-0 mt-4">
                                                        
                                                </div> -->

                                                {% if p.paid %}
                                                <br>
                                                <br>
                                                <br>
                                                <form method="POST" action="/deletebooking/{{p.pk}}/">
                                                    {% csrf_token %}<input class="btn btn-danger confirm-cancel1" type="submit" value="Clear from History">
                                                </form>
                                                 {% else %}
                                                    <form method="POST" action="/deletebooking/{{p.pk}}/">
                                                            {% csrf_token %}<input class="btn btn-danger confirm-cancel1" type="submit" value="Cancel Booking">
                                                    </form>
                                                    {% endif %}
                                                    </div>
                                        </div>
                                    </div>
                                </div>

                                {% endfor %}
                                <!-- ============================================================== -->
                                <!-- end card influencer one -->
                                <!-- ============================================================== -->


                            <!-- ============================================================== -->

                                <!-- ============================================================== -->
                                <!-- end card influencer one -->
                                <!-- ============================================================== -->
                                <!-- ============================================================== -->
                        
                                <!-- ============================================================== -->
                                <!-- end card influencer one -->
                                <!-- ============================================================== -->
                                <!-- ============================================================== -->
                            <!-- card influencer one -->
                            <!-- ============================================================== -->
                       
                           
                                <!-- ============================================================== -->
                                <!-- end card influencer one -->
                                <!-- ============================================================== -->
                                

                                <!-- ============================================================== -->
                                <!-- end content -->
                                <!-- ============================================================== -->
                            </div>
                            <!-- ============================================================== -->
                            <!-- influencer sidebar  -->
                            <!-- ============================================================== -->

                            <!-- ============================================================== -->
                            <!-- end influencer sidebar  -->
                            <!-- ============================================================== -->
                        </div>
                    </div>
                    <!-- ============================================================== -->
                    <!-- footer -->
                    <!-- ============================================================== -->
                    <div class="footer">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    Copyright © 2019. All rights reserved.</a>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <div class="text-md-right footer-links d-none d-sm-block">
                                        <a href="javascript: void(0);">About</a>
                                        <a href="javascript: void(0);">Support</a>
                                        <a href="javascript: void(0);">Contact Us</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- ============================================================== -->
                    <!-- end footer -->
                    <!-- ============================================================== -->
                </div>
{% endblock %}

{% block javascript %}
<!-- ============================================================== -->
<!-- end main wrapper  -->
<!-- ============================================================== -->
<!-- Optional JavaScript -->
<!-- jquery 3.3.1 -->
<script src="{% static 'vendor/jquery/jquery-3.3.1.min.js' %}?{% now "U" %}"></script>
<!-- bootstap bundle js -->
<script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.js' %}?{% now "U" %}"></script>
<!-- slimscroll js -->
<script src="{% static 'vendor/slimscroll/jquery.slimscroll.js' %}?{% now "U" %}"></script>
<!-- main js -->
<script src="{% static 'libs/js/main-js.js' %}?{% now "U" %}"></script>

<!-- Custom JS -->
<script src="{% static 'libs/js/othermiscjs.js' %}?{% now "U" %}"></script>
<script>
/* ----- JavaScript ----- */
$(function () {
  $("#custom-modal").modal("show");
});

/* Close the popup when the a selection is made */
$("#selectCity").on("change", function () {
  $("#custom-modal").modal("hide");
});
</script>
{% endblock %}